import numpy as np
from scipy.stats import f

# ================= ДАНІ =================
X = np.array([1, 3, 5, 7, 9, 11, 13, 15, 17], dtype=float)
Y = np.array([0.99, 0.83, 0.45, 0.39, 0.23, 0.14, 0.09, 0.03, 0.01], dtype=float)
n = len(X)

# ================= ЕКСПОНЕНЦІАЛЬНА МОДЕЛЬ =================
# Модель: y = A * exp(Bx)
mask = Y > 0
lnY = np.log(Y[mask])

# МНК для ln(y) = ln(A) + Bx
B, lnA = np.polyfit(X[mask], lnY, 1)
A = np.exp(lnA)

# Прогнозні значення
Y_pred = A * np.exp(B * X)

# ================= РОЗРАХУНКИ =================
SS_res = np.sum((Y - Y_pred) ** 2)
SS_tot = np.sum((Y - np.mean(Y)) ** 2)

# R^2
R2 = 1 - SS_res / SS_tot

# Критерій Фішера
p = 2  # кількість параметрів (A, B)
df1 = p - 1
df2 = n - p

MS_reg = (SS_tot - SS_res) / df1
MS_res = SS_res / df2

F = MS_reg / MS_res
F_crit = f.ppf(0.95, df1, df2)

# ================= ВИВЕДЕННЯ =================
print("===========================РЕЗУЛЬТАТИ==================")
print(f"R^2 = {R2:.6f}")
print(f"F = {F:.6f}")
print(f"F критичне = {F_crit:.6f}")

if F > F_crit:
    print("✅ Модель адекватна (F > Fкр)")
else:
    print("❌ Модель неадекватна (F ≤ Fкр)")
    
    
print("===========================ВИСНОВОК==================")
print("Так як наше отримане значення за критерієм Фішера більше ніж критичне,  можна зробити висновок, що модель адекватно відображає дані")